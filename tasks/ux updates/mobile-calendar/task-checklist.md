# Mobile Calendar — Нумерованный чеклист (на основе промпта)

1) Утвердить гибридный паттерн — [Выполнено]
   - Desktop: `Popover` (выпадает вниз).
   - Mobile: `Drawer` (Bottom Sheet) снизу, допускается nested Drawer.

2) Определить способ детекции устройства — [Выполнено]
   - Использован существующий `useDeviceType()` (mobile/tablet/desktop).

3) Спроектировать новый переиспользуемый компонент — [Выполнено]
   - Имя: `HybridDatePicker` (в `src/components/ui-elements/`).
   - Пропсы: `selectedDate`, `onSelect(date)`, `disabled?`, `label?`, `className?`.
   - Единая реализация контента календаря, рендер в `Popover` или `Drawer`.

4) Использовать только shadcn/ui компоненты — [Выполнено]
   - `Calendar`, `Popover`, `PopoverTrigger`, `PopoverContent`.
   - `Sheet` (вместо Drawer), `SheetTrigger`, `SheetContent`, `SheetFooter`, `SheetClose`.

5) Локализация и форматирование дат — [Выполнено]
   - `useLocale()` → маппинг `date-fns` locale с fallback `enUS`.
   - Кнопка: `format(date, "PPP", { locale })`.

6) Поведение открытия/закрытия — [Выполнено]
   - Закрытие после выбора даты и по «Cancel» в мобильной версии.
   - `initialFocus` у календаря; возврат фокуса реализован в `Sheet`.

7) Быстрые пресеты для мобильной версии — [Выполнено]
   - Компонент: `CalendarQuickPresets` (в `ui-elements`).
   - «Сегодня», «Вчера», «Позавчера»; на мобилке высота кнопок пресетов +5px.
   - `onSelect(presetDate)` закрывает шторку.

8) UX и ограничения — [Выполнено]
   - Темы не менялись; выравнивание, доступность, запрет будущих дат сохранены.

9) Z-index и наложения — [Выполнено]
   - Использован `Sheet` с оверлеем и блокировкой скролла; без конфликтов с модалкой.

10) Интеграции — [Выполнено]
    - Заменён `CustomDatePicker` на `HybridDatePicker` в:
      - `TransactionModal.tsx`
      - `EditTransactionModal.tsx`
      - `RecurringRulesSettings.tsx`
      - `BudgetDetailsForm.tsx`

11) Совместимость с чат-пресетами — [Выполнено]
    - Чат-пресеты не трогались; `CalendarQuickPresets` используется только в мобильной шторке.

12) Тестирование и QA — [Выполнено]
    - Ручная проверка сценариев (мобильный/десктоп), закрытия, локали, крайних случаев.

13) Производительность и стабильность — [Выполнено]
    - Состояние `open` контролируемое; без кастомных порталов на мобилке.

14) Документация — [Не выполнено]
    - Требуется обновить README/DEV.md после утверждения кода.

15) Критерии готовности — [Частично выполнено]
    - Реализация соответствует; документируем и прогоним ещё раз ручное тестирование.