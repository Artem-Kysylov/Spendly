# Перенос остатка (Rollover) — чеклист

1. [x] Добавить типы: RolloverMode, BudgetRolloverSettings
2. [x] Добавить глобальные настройки пользователя: defaultRolloverEnabled
3. [x] Расширить BudgetFolderItemProps флагами переноса
4. [x] Создать MonthlyBudgetCategory тип с полями rolloverFromPrev и available
5. [x] Утилита расчёта переноса (computeCarry, clamp)
6. [x] Формула available = allocated + rolloverFromPrev − spent
7. [x] Идемпотентность применения переноса (алгоритм/идеи)
8. [x] Генерация ключей месяца (formatMonthKey)
9. [x] shouldApplyRollover (условия применения)
10. [x] applyToNextMonth (базовая логика, без записи)
11. [x] Хук useRollover для применения при открытии месяца

12. [x] Обновление следующего месяца: allocated_{M+1} = baseAllocated + carry
13. [x] Политика при смене флага переноса (базовая поддержка на клиенте)
14. [x] Исключить доходы/переводы и архивные категории (доходы исключены)
15. [x] Обработка мультивалютности (ограничение, единая валюта)
16. [x] Интеграция с кэшем графиков (ключ rollover)
17. [x] Обновить утилиты запросов графиков для расчёта превью
18. [x] UI: переключатель и режим переноса в модалке категории
19. [x] UI: бейдж «Перенос/Перерасход» на карточке категории
20. [x] UI: индикатор сводного переноса в шапке бюджетов
21. [x] UI: предупреждение о негативном переносе (перерасход бейдж)

22. [ ] Сохранение настроек переноса в Supabase
23. [ ] Миграции: новые поля в таблицах (если нужно)
24. [ ] E2E: сценарии с разными режимами переноса
25. [ ] Unit: тесты утилит и хуков
26. [ ] UI: локализация строк для переноса
27. [ ] UI: детальная панель источника переноса
28. [ ] Триггеры: применение при входе в новый месяц
29. [ ] Ограничения: кап по переносам
30. [ ] Rollback-план
31. [ ] Документация
32. [ ] Производительность и кэширование
33. [ ] QA-план