import type { Language } from "@/types/locale";

export type NotificationCategory = 
  | "daily_reminder" 
  | "budget_alert" 
  | "aggressive" 
  | "retention";

export type NotificationVariant = 
  | "standard" 
  | "action_oriented" 
  | "casual" 
  | "short" 
  | "professional"
  | "warning_80"
  | "limit_reached"
  | "over_budget"
  | "saving_goal"
  | "urgent"
  | "direct"
  | "provocative"
  | "persistence"
  | "friendly"
  | "insight_based"
  | "goal_focused";

type LocalizedString = string | ((params: Record<string, string | number>) => string);

interface NotificationTemplate {
  en: LocalizedString;
  ru: LocalizedString;
  [key: string]: LocalizedString; // Support for other languages
}

export const NOTIFICATION_STRINGS: Record<NotificationCategory, Record<string, NotificationTemplate>> = {
  daily_reminder: {
    standard: {
      en: "Time for a quick check-in! Did you spend anything today?",
      ru: "ะัะตะผั ะฑััััะพะน ะฟัะพะฒะตัะบะธ! ะัะปะธ ะปะธ ััะฐัั ัะตะณะพะดะฝั?",
      uk: "ะงะฐั ัะฒะธะดะบะพั ะฟะตัะตะฒััะบะธ! ะัะปะธ ะฒะธััะฐัะธ ััะพะณะพะดะฝั?",
      hi: "เคคเฅเคเคผ เคเฅเค-เคเคจ เคเคพ เคธเคฎเคฏ! เคเฅเคฏเคพ เคเค เคเฅเค เคเคฐเฅเค เคนเฅเค?",
      id: "Waktunya cek cepat! Ada pengeluaran hari ini?",
      ja: "ใใฃใจ็ขบ่ชใใพใใใใไปๆฅใฏๅบ่ฒปใใใใพใใใ๏ผ",
      ko: "๋น๋ฅธ ์ฒดํฌ์ธ ์๊ฐ์ด์์! ์ค๋ ์ง์ถ์ด ์์๋์?"
    },
    action_oriented: {
      en: "Keep your streak alive! Log your expenses for today.",
      ru: "ะะพะดะดะตัะถะธ ัะตัะธั! ะะฐะฟะธัะธ ัะฒะพะธ ัะฐััะพะดั ะทะฐ ัะตะณะพะดะฝั.",
      uk: "ะัะดััะธะผะฐะน ัะตััั! ะะฐะฟะธัะธ ะฒะธััะฐัะธ ะทะฐ ััะพะณะพะดะฝั.",
      hi: "เคเคชเคจเฅ เคธเฅเคเฅเคฐเฅเค เคฌเคจเคพเค เคฐเคเฅเค! เคเค เคเฅ เคเคฐเฅเค เคฆเคฐเฅเค เคเคฐเฅเคเฅค",
      id: "Pertahankan streak-mu! Catat pengeluaran hari ini.",
      ja: "้ฃ็ถ่จ้ฒใใญใผใ๏ผไปๆฅใฎๆฏๅบใ่จ้ฒใใพใใใใ",
      ko: "์ฐ์ ๊ธฐ๋ก์ ์ด์ด๊ฐ์! ์ค๋ ์ง์ถ์ ๊ธฐ๋กํ์ธ์."
    },
    casual: {
      en: "Evening update: How's your wallet feeling? Add your transactions now.",
      ru: "ะะตัะตัะฝะธะน ะฐะฟะดะตะนั: ะะฐะบ ัะฐะผ ัะฒะพะน ะบะพัะตะปะตะบ? ะะพะฑะฐะฒั ััะฐะฝะทะฐะบัะธะธ ัะตะนัะฐั.",
      uk: "ะะตัััะฝัะน ะฐะฟะดะตะนั: ัะบ ัะฒัะน ะณะฐะผะฐะฝะตัั? ะะพะดะฐะน ััะฐะฝะทะฐะบััั ะทะฐัะฐะท.",
      hi: "เคถเคพเคฎ เคเคพ เคเคชเคกเฅเค: เคเคชเคเคพ เคตเฅเคฒเฅเค เคเฅเคธเคพ เคนเฅ? เคเคญเฅ เคฒเฅเคจ-เคฆเฅเคจ เคเฅเคกเคผเฅเคเฅค",
      id: "Update malam: dompetmu gimana? Tambahkan transaksi sekarang.",
      ja: "ๅคใฎใใงใใฏ๏ผใ่ฒกๅธใฎ่ชฟๅญใฏใฉใ๏ผไปใใๅๅผใ่ฟฝๅใใใใ",
      ko: "์๋ ์๋ฐ์ดํธ: ์ง๊ฐ ์ํ๋ ์ด๋์? ์ง๊ธ ๊ฑฐ๋๋ฅผ ์ถ๊ฐํ์ธ์."
    },
    short: {
      en: "Don't forget to track your spending! ๐ฐ",
      ru: "ะะต ะทะฐะฑัะดั ะทะฐะฟะธัะฐัั ัะฐััะพะดั! ๐ฐ",
      uk: "ะะต ะทะฐะฑัะดั ะทะฐะฟะธัะฐัะธ ะฒะธััะฐัะธ! ๐ฐ",
      hi: "เคเคชเคจเฅ เคเคฐเฅเค เคเฅเคฐเฅเค เคเคฐเคจเคพ เคจ เคญเฅเคฒเฅเค! ๐ฐ",
      id: "Jangan lupa catat pengeluaranmu! ๐ฐ",
      ja: "ๆฏๅบใฎ่จ้ฒใๅฟใใใซ๏ผ๐ฐ",
      ko: "์ง์ถ ๊ธฐ๋ก ์์ง ๋ง์ธ์! ๐ฐ"
    },
    professional: {
      en: "Stay on top of your finances. Record your daily activity in Spendly.",
      ru: "ะะตัะถะธ ัะธะฝะฐะฝัั ะฟะพะด ะบะพะฝััะพะปะตะผ. ะะฐะฟะธัะธ ะดะฝะตะฒะฝัั ะฐะบัะธะฒะฝะพััั ะฒ Spendly.",
      uk: "ะขัะธะผะฐะน ััะฝะฐะฝัะธ ะฟัะด ะบะพะฝััะพะปะตะผ. ะะฐะฟะธัะธ ัะพะดะตะฝะฝั ะฐะบัะธะฒะฝัััั ั Spendly.",
      hi: "เคเคชเคจเฅ เคตเคฟเคคเฅเคค เคชเคฐ เคจเคฟเคฏเคเคคเฅเคฐเคฃ เคฐเคเฅเคเฅค Spendly เคฎเฅเค เคฐเฅเคเคผ เคเฅ เคเคคเคฟเคตเคฟเคงเคฟ เคฆเคฐเฅเค เคเคฐเฅเคเฅค",
      id: "Tetap kendalikan keuanganmu. Catat aktivitas harianmu di Spendly.",
      ja: "ๅฎถ่จใๆๆกใใพใใใใSpendlyใงไปๆฅใฎ่จ้ฒใๆฎใใฆใใใใใ",
      ko: "์ฌ์์ ๊ด๋ฆฌํ์ธ์. Spendly์ ์ผ์ผ ํ๋์ ๊ธฐ๋กํด์."
    }
  },
  budget_alert: {
    warning_80: {
      en: (p) => `Heads up! Youโve used 80% of your ${p.category} budget.`,
      ru: (p) => `ะะฝะธะผะฐะฝะธะต! ะั ะธัะฟะพะปัะทะพะฒะฐะปะธ 80% ะฑัะดะถะตัะฐ ะบะฐัะตะณะพัะธะธ ${p.category}.`,
      uk: (p) => `ะฃะฒะฐะณะฐ! ะะธ ะฒะธะบะพัะธััะฐะปะธ 80% ะฑัะดะถะตัั ะบะฐัะตะณะพััั ${p.category}.`,
      hi: (p) => `เคงเฅเคฏเคพเคจ เคฆเฅเค! เคเคชเคจเฅ ${p.category} เคฌเคเค เคเคพ 80% เคเคชเคฏเฅเค เคเคฐ เคฒเคฟเคฏเคพ เคนเฅเฅค`,
      id: (p) => `Perhatian! Kamu sudah memakai 80% anggaran ${p.category}.`,
      ja: (p) => `ๆณจๆ๏ผ${p.category} ใฎไบ็ฎใ80%ไฝฟใใพใใใ`,
      ko: (p) => `์ฃผ์! ${p.category} ์์ฐ์ 80%๋ฅผ ์ฌ์ฉํ์ด์.`
    },
    limit_reached: {
      en: (p) => `Budget Alert: You've reached your limit for ${p.category}. Time to slow down?`,
      ru: (p) => `ะะปะตัั ะฑัะดะถะตัะฐ: ะั ะดะพััะธะณะปะธ ะปะธะผะธัะฐ ะฟะพ ${p.category}. ะะพัะฐ ะฟัะธัะพัะผะพะทะธัั?`,
      uk: (p) => `ะัะดะถะตั: ะฒะธ ะดะพััะณะปะธ ะปัะผััั ะดะปั ${p.category}. ะงะฐั ะฟัะธะณะฐะปัะผัะฒะฐัะธ?`,
      hi: (p) => `เคฌเคเค เคเคฒเคฐเฅเค: ${p.category} เคเฅ เคฒเคฟเค เคเคชเคเคพ เคฒเคฟเคฎเคฟเค เคชเฅเคฐเคพ เคนเฅ เคเคฏเคพ เคนเฅเฅค เคฅเฅเคกเคผเคพ เคงเฅเคฎเฅ?`,
      id: (p) => `Peringatan: kamu sudah mencapai batas anggaran ${p.category}. Saatnya mengerem?`,
      ja: (p) => `ไบ็ฎใขใฉใผใ๏ผ${p.category} ใฎไธ้ใซ้ใใพใใใๅฐใๆใใพใใ๏ผ`,
      ko: (p) => `์์ฐ ์๋ฆผ: ${p.category} ํ๋์ ๋๋ฌํ์ด์. ์๋๋ฅผ ์ค์ผ๊น์?`
    },
    over_budget: {
      en: (p) => `Oops! You've exceeded your ${p.category} budget. Want to adjust it?`,
      ru: (p) => `ะฃะฟั! ะั ะฟัะตะฒััะธะปะธ ะฑัะดะถะตั ะฟะพ ${p.category}. ะฅะพัะธัะต ัะบะพััะตะบัะธัะพะฒะฐัั?`,
      uk: (p) => `ะะน! ะะธ ะฟะตัะตะฒะธัะธะปะธ ะฑัะดะถะตั ะดะปั ${p.category}. ะฅะพัะตัะต ะทะผัะฝะธัะธ ะนะพะณะพ?`,
      hi: (p) => `เคเคน! เคเคชเคจเฅ ${p.category} เคเคพ เคฌเคเค เคชเคพเคฐ เคเคฐ เคฒเคฟเคฏเคพ เคนเฅเฅค เคเฅเคฏเคพ เคเคธเฅ เคฌเคฆเคฒเคจเคพ เคเคพเคนเฅเคเคเฅ?`,
      id: (p) => `Ups! Kamu melewati anggaran ${p.category}. Mau menyesuaikannya?`,
      ja: (p) => `ใใฃใจ๏ผ${p.category} ใฎไบ็ฎใ่ถใใพใใใ่ชฟๆดใใพใใ๏ผ`,
      ko: (p) => `์! ${p.category} ์์ฐ์ ์ด๊ณผํ์ด์. ์กฐ์ํ๊น์?`
    },
    saving_goal: {
      en: "You're doing great! Youโve spent less than usual this week. Keep it up!",
      ru: "ะัะปะธัะฝะฐั ัะฐะฑะพัะฐ! ะั ะฟะพััะฐัะธะปะธ ะผะตะฝััะต ะพะฑััะฝะพะณะพ ะฝะฐ ััะพะน ะฝะตะดะตะปะต. ะขะฐะบ ะดะตัะถะฐัั!",
      uk: "ะงัะดะพะฒะฐ ัะพะฑะพัะฐ! ะฆัะพะณะพ ัะธะถะฝั ะฒะธ ะฒะธััะฐัะธะปะธ ะผะตะฝัะต, ะฝัะถ ะทะฐะทะฒะธัะฐะน. ะขะฐะบ ััะธะผะฐัะธ!",
      hi: "เคถเคพเคจเคฆเคพเคฐ! เคเคธ เคนเคซเฅเคคเฅ เคเคชเคจเฅ เคธเคพเคฎเคพเคจเฅเคฏ เคธเฅ เคเคฎ เคเคฐเฅเค เคเคฟเคฏเคพ เคนเฅเฅค เคเคธเฅ เคนเฅ เคเคพเคฐเฅ เคฐเคเฅเค!",
      id: "Keren! Minggu ini kamu belanja lebih sedikit dari biasanya. Pertahankan!",
      ja: "ใใๆใ๏ผไป้ฑใฏใใคใใใๆฏๅบใๅฐใชใใงใใใใฎ่ชฟๅญใง๏ผ",
      ko: "์ข์์! ์ด๋ฒ ์ฃผ์ ํ์๋ณด๋ค ๋ ์ผ์ด์. ๊ณ์ ์์งํด์!"
    }
  },
  aggressive: {
    urgent: {
      en: "Unrecorded expenses detected? (Probably). Open Spendly and stay accurate!",
      ru: "ะะฑะฝะฐััะถะตะฝั ะฝะตัััะตะฝะฝัะต ัะฐััะพะดั? (ะะตัะพััะฝะพ). ะัะบัะพะน Spendly ะธ ะฑัะดั ัะพัะตะฝ!",
      uk: "ะะตะพะฑะปัะบะพะฒะฐะฝั ะฒะธััะฐัะธ? (ะะผะพะฒััะฝะพ). ะัะดะบัะธะน Spendly ั ะฒะตะดะธ ะพะฑะปัะบ ัะพัะฝะพ!",
      hi: "เคเคจเคฐเคฟเคเฅเคฐเฅเคกเฅเคก เคเคฐเฅเค? (เคถเคพเคฏเคฆ)เฅค Spendly เคเฅเคฒเฅเค เคเคฐ เคฐเคฟเคเฅเคฐเฅเคก เคธเคนเฅ เคฐเคเฅเค!",
      id: "Ada pengeluaran yang belum dicatat? (Mungkin). Buka Spendly dan tetap akurat!",
      ja: "ๆช่จ้ฒใฎๆฏๅบใใใใใ๏ผSpendlyใ้ใใฆๆญฃ็ขบใซ่จ้ฒใใใ๏ผ",
      ko: "๊ธฐ๋ก ์ ๋ ์ง์ถ์ด ์๋์? (์๋ง๋). Spendly๋ฅผ ์ด๊ณ ์ํํ ๊ธฐ๋กํ์ธ์!"
    },
    direct: {
      en: "Hey! Your budget won't track itself. Log your spending now.",
      ru: "ะญะน! ะัะดะถะตั ัะฐะผ ัะตะฑั ะฝะต ะฟะพััะธัะฐะตั. ะะฐะฟะธัะธ ัะฐััะพะดั ัะตะนัะฐั.",
      uk: "ะะตะน! ะัะดะถะตั ัะฐะผ ัะตะฑะต ะฝะต ะฟะพัะฐััััััั. ะะฐะฟะธัะธ ะฒะธััะฐัะธ ะทะฐัะฐะท.",
      hi: "เคเคฐเฅ! เคฌเคเค เคเฅเคฆ เคจเคนเฅเค เคเคฟเคจเฅเคเคพเฅค เคเคญเฅ เคเคชเคจเฅ เคเคฐเฅเค เคฆเคฐเฅเค เคเคฐเฅเคเฅค",
      id: "Hei! Anggaran tidak akan mencatat sendiri. Catat pengeluaranmu sekarang.",
      ja: "ใใผใ๏ผไบ็ฎใฏๅๆใซ่จ้ฒใใใพใใใไปใใๆฏๅบใๅฅๅใใใใ",
      ko: "์ผ! ์์ฐ์ ์ค์ค๋ก ๊ธฐ๋ก๋์ง ์์์. ์ง๊ธ ์ง์ถ์ ๊ธฐ๋กํ์ธ์."
    },
    provocative: {
      en: "Is your wallet getting lighter? Make sure you know where the money went.",
      ru: "ะะพัะตะปะตะบ ััะฐะฝะพะฒะธััั ะปะตะณัะต? ะฃะฑะตะดะธัั, ััะพ ะทะฝะฐะตัั, ะบัะดะฐ ััะปะธ ะดะตะฝัะณะธ.",
      uk: "ะะฐะผะฐะฝะตัั ะปะตะณัะฐั? ะะตัะตะบะพะฝะฐะนัั, ัะพ ะทะฝะฐัั, ะบัะดะธ ะฟััะปะธ ะณัะพัั.",
      hi: "เคตเฅเคฒเฅเค เคนเคฒเฅเคเคพ เคฒเค เคฐเคนเคพ เคนเฅ? เคฆเฅเค เคฒเฅเค เคชเฅเคธเคพ เคเคนเคพเค เคเคฏเคพเฅค",
      id: "Dompet makin tipis? Pastikan kamu tahu uangnya ke mana.",
      ja: "ใ่ฒกๅธใ่ปฝใใชใฃใฆใชใ๏ผใ้ใฎ่กใๅใๆๆกใใใใ",
      ko: "์ง๊ฐ์ด ๊ฐ๋ฒผ์์ก๋์? ๋์ด ์ด๋๋ก ๊ฐ๋์ง ํ์ธํด์."
    },
    persistence: {
      en: "Quick reminder: Accuracy is key. It takes only 10 seconds to add a transaction.",
      ru: "ะะฐะฟะพะผะธะฝะฐะฝะธะต: ะขะพัะฝะพััั โ ััะพ ะบะปัั. ะะพะฑะฐะฒะปะตะฝะธะต ััะฐะฝะทะฐะบัะธะธ ะทะฐะฝะธะผะฐะตั ะฒัะตะณะพ 10 ัะตะบัะฝะด.",
      uk: "ะะฐะณะฐะดัะฒะฐะฝะฝั: ัะพัะฝัััั ะฒะฐะถะปะธะฒะฐ. ะะพะดะฐัะธ ััะฐะฝะทะฐะบััั โ ะปะธัะต 10 ัะตะบัะฝะด.",
      hi: "เคเฅเคเคพ เคฐเคฟเคฎเคพเคเคเคกเคฐ: เคธเคเฅเคเคคเคพ เคเคฐเฅเคฐเฅ เคนเฅเฅค เคเฅเคฐเคพเคเคเคผเฅเคเฅเคถเคจ เคเฅเคกเคผเคจเฅ เคฎเฅเค เคธเคฟเคฐเฅเคซ 10 เคธเฅเคเคเคก เคฒเคเคคเฅ เคนเฅเคเฅค",
      id: "Pengingat cepat: Akurasi itu penting. Tambah transaksi cuma 10 detik.",
      ja: "ใชใใคใณใ๏ผๆญฃ็ขบใใๅคงไบใๅๅผ่ฟฝๅใฏ10็งใงใงใใพใใ",
      ko: "๋น๋ฅธ ์๋ฆผ: ์ํ์ฑ์ด ํต์ฌ์ด์์. ๊ฑฐ๋ ์ถ๊ฐ๋ 10์ด๋ฉด ์ถฉ๋ถํด์."
    }
  },
  retention: {
    friendly: {
      en: "We miss you! Come back and see how your savings are doing.",
      ru: "ะั ัะบััะฐะตะผ! ะะพะทะฒัะฐัะฐะนัั ะธ ะฟะพัะผะพััะธ, ะบะฐะบ ะดะตะปะฐ ั ัะฒะพะธั ะฝะฐะบะพะฟะปะตะฝะธะน.",
      uk: "ะะธ ััะผััะผะพ! ะะพะฒะตััะฐะนัั ะน ะฟะพะดะธะฒะธัั, ัะบ ัะฒะพั ะทะฐะพัะฐะดะถะตะฝะฝั.",
      hi: "เคนเคฎ เคเคชเคเฅ เคฏเคพเคฆ เคเคฐ เคฐเคนเฅ เคนเฅเค! เคตเคพเคชเคธ เคเคเค เคเคฐ เคฆเฅเคเฅเค เคเคชเคเฅ เคฌเคเคค เคเฅเคธเฅ เคเคฒ เคฐเคนเฅ เคนเฅเฅค",
      id: "Kami kangen! Kembali dan lihat perkembangan tabunganmu.",
      ja: "ใไนใใถใ๏ผ่ฒฏ้ใฎ่ชฟๅญใ่ฆใซๆปใฃใฆใใฆใ",
      ko: "๊ทธ๋ฆฌ์์ด์! ๋์์์ ์์ถ ์ํฉ์ ํ์ธํด์."
    },
    insight_based: {
      en: "Itโs been a while. See your weekly spending summary inside.",
      ru: "ะะฐะฒะฝะพ ะฝะต ะฒะธะดะตะปะธัั. ะขะฒะพะน ะตะถะตะฝะตะดะตะปัะฝัะน ะพััะตั ะฒะฝัััะธ.",
      uk: "ะะฐะฒะฝะพ ะฝะต ะฑะฐัะธะปะธัั. ะฃัะตัะตะดะธะฝั โ ัะฒัะน ัะธะถะฝะตะฒะธะน ะฟัะดััะผะพะบ ะฒะธััะฐั.",
      hi: "เคเคพเคซเคผเฅ เคธเคฎเคฏ เคนเฅ เคเคฏเคพเฅค เคเคเคฆเคฐ เคเคชเคเคพ เคธเคพเคชเฅเคคเคพเคนเคฟเค เคเคฐเฅเค เคธเคพเคฐเคพเคเคถ เคนเฅเฅค",
      id: "Sudah lama ya. Lihat ringkasan pengeluaran mingguanmu di dalam.",
      ja: "ใใฐใใใถใ๏ผไธญใซ้ฑๆฌกใฎๆฏๅบใตใใชใผใใใใพใใ",
      ko: "์ค๋๋ง์ด์์. ์์์ ์ฃผ๊ฐ ์ง์ถ ์์ฝ์ ํ์ธํ์ธ์."
    },
    goal_focused: {
      en: "Ready to reach your financial goals? Let's get back to tracking!",
      ru: "ะะพัะพะฒ ะดะพััะธัั ัะธะฝะฐะฝัะพะฒัั ัะตะปะตะน? ะะฐะฒะฐะน ะฒะตัะฝะตะผัั ะบ ััะตัั!",
      uk: "ะะพัะพะฒะธะน ะดะพััะณัะธ ััะฝะฐะฝัะพะฒะธั ััะปะตะน? ะะพะฒะตัะฝัะผะพัั ะดะพ ััะตะบัะฝะณั!",
      hi: "เคเคชเคจเฅ เคตเคฟเคคเฅเคคเฅเคฏ เคฒเคเฅเคทเฅเคฏ เคนเคพเคธเคฟเคฒ เคเคฐเคจเฅ เคเฅ เคฒเคฟเค เคคเฅเคฏเคพเคฐ? เคเคฒเคฟเค เคซเคฟเคฐ เคธเฅ เคเฅเคฐเฅเคเคฟเคเค เคถเฅเคฐเฅ เคเคฐเฅเค!",
      id: "Siap capai tujuan finansialmu? Yuk kembali mencatat!",
      ja: "็ฎๆจ้ๆใฎๆบๅใฏใงใใ๏ผใพใ่จ้ฒใๅงใใใ๏ผ",
      ko: "์ฌ๋ฌด ๋ชฉํ๋ฅผ ๋ฌ์ฑํ ์ค๋น๋๋์? ๋ค์ ๊ธฐ๋ก์ ์์ํด์!"
    }
  }
};

/**
 * Helper to get a random notification message from a category
 */
export function getNotificationMessage(
  category: NotificationCategory,
  locale: Language,
  params?: Record<string, string | number>,
  variant?: NotificationVariant
): string {
  const categoryTemplates = NOTIFICATION_STRINGS[category];
  if (!categoryTemplates) return "";

  let selectedTemplate: NotificationTemplate;

  if (variant && categoryTemplates[variant]) {
    selectedTemplate = categoryTemplates[variant];
  } else {
    // Pick random variant
    const variants = Object.values(categoryTemplates);
    selectedTemplate = variants[Math.floor(Math.random() * variants.length)];
  }

  // Fallback to 'en' if locale not found
  const raw = (selectedTemplate as any)[locale] || selectedTemplate.en;

  if (typeof raw === "function") {
    return raw(params || {});
  }
  return raw;
}
