# Spendly TODO

Обновлено: 2025-10-03

## Срочно (сейчас)

- [ ] AI подтверждение транзакции:
  - [ ] Отображать подробности операции в панели подтверждения: Title, Budget, Amount (форматировать через formatCurrency)
  - [ ] Кнопки переименовать на «Accept» и «Decline», добавить aria-метки
  - [ ] При открытии панели переводить фокус на «Accept» (улучшение доступности)
  - [ ] (Опционально) Предоставить возможность корректировки title/amount/budget перед подтверждением (маленькая форма с валидацией)

- [ ] Единообразие лимитов запросов:
  - [ ] Временно отключить лимиты запросов по всему клиентскому коду (привести enableLimits к false там, где сейчас true)
  - [ ] Оставить поддержку логирования использования на сервере (уже есть в /api/assistant), но без блокировки на клиенте
  - [ ] Вынести включение лимитов в конфиг/переменные окружения, чтобы легко включать перед релизом

- [ ] UX мелочи:
  - [ ] Подтверждающая панель: показать budget_name, а при отсутствии — подсветить, что бюджет не найден
  - [ ] Единые тексты ошибок и статусов (rate limit, отмена, подтверждение) для ассистента и подсказок

## Короткий срок

- [ ] События обновления данных:
  - [ ] Убедиться, что все графики и таблицы подписаны на 'budgetTransactionAdded' и корректно рефетчатся
  - [ ] Добавить типизацию для CustomEvent и централизованный helper-диспетчер (минимальный event bus)

- [ ] Ввод/отмена:
  - [ ] «Abort» на стримирующих ответах — убедиться, что визуально понятно, что поток прерван (всплывающий тост/сообщение)

## На будущее (после стабилизации)

- [ ] Локализация (i18n):
  - [ ] Выбор стека (next-intl или i18next) и базовая интеграция
  - [ ] Вынести тексты ассистента, модалок, графиков, таблиц в словари
  - [ ] Структура: src/i18n/{en,ru}/..., ключи по компонентам
  - [ ] Ленивая загрузка словарей, переключение языка, покрыть базовые сценарии
  - [ ] Гайд по добавлению новых ключей и проверке отсутствующих переводов

- [ ] Лимиты подписок:
  - [ ] Разделение free/pro лимитов (дневные/месячные), централизованная конфигурация
  - [ ] UI-индикаторы (баннер/лейбл в чате и подсказках), дружелюбные сообщения, CTA на апгрейд
  - [ ] Серверная защита (429) с согласованным форматом ошибки
  - [ ] Прозрачная метрика использования: простая страница/виджет с счётчиком запросов
  - [ ] E2E-проверки сценариев превышения лимита

- [ ] Тестирование:
  - [ ] Юнит-тесты для парсинга команд (add to budget), подтверждения/отмены, событий refetch
  - [ ] Интеграционные тесты для /api/assistant (action → confirm → shouldRefetch)

## Примечания

- Лимиты и локализацию сейчас не включаем — задачи зафиксированы для плановой реализации позже.
- Приоритет — UI панели подтверждения и устранение несоответствий в enableLimits на фронтенде.